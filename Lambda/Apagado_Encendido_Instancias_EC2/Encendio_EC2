import boto3

def lambda_handler(event, context):
    region = 'us-east-1'  # Reemplaza con tu regi칩n
    instances = ['i-0f9c8fcb86755121f']  # Lista de IDs de instancias, cada instancia va entre 

    ec2 = boto3.client('ec2', region_name=region)

    try:
        # Obtener el estado actual de las instancias
        response = ec2.describe_instances(InstanceIds=instances)
        stopped_instances = []

        for reservation in response['Reservations']:
            for instance in reservation['Instances']:
                if instance['State']['Name'] == 'stopped':
                    stopped_instances.append(instance['InstanceId'])

        # Iniciar solo las instancias que est치n detenidas (stopped)
        if stopped_instances:
            ec2.start_instances(InstanceIds=stopped_instances)
            print(f"Iniciando instancias: {stopped_instances}")
            return {"status": "success", "started_instances": stopped_instances}
        else:
            print("No hay instancias en estado 'stopped' para iniciar.")
            return {"status": "no_action", "message": "Todas las instancias ya est치n en ejecuci칩n o en un estado incorrecto."}

    except Exception as e:
        print(f"Error al iniciar instancias: {str(e)}")
        return {"status": "error", "message": str(e)}

